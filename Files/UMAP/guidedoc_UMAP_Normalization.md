
### **给AI Coding Agent的任务指令**

**目标 (Objective):**
为单细胞RNA-seq数据生成一个经过“降采样”处理的UMAP图，以实现视觉上的均一化。此方法旨在解决因不同样本间细胞总数不一致而导致的视觉偏倚问题，从而能在一张图中公平地展示各组细胞的相对比例和分布。

**输入数据 (Input Data):**
*   **文件:** `[这里填写您的RDS文件名，例如 nk_merged.rds]`
*   **对象:** 文件中包含一个名为 `[这里填写您的Seurat对象名，例如 nk.integrated]` 的Seurat对象。

**关键参数 (Key Parameter):**
*   **分组列名:** 请使用Seurat对象元数据(metadata)中的 `[这里填写用于分组的列名]` 这一列来进行降采样。
    *   **说明:** 这一列定义了需要被均一化的组别。例如，它可能是 `sample_id` (包含NCD_CD45.2, MCD-1W_NK1.1等)，或者是您创建的更宏观的分组，如 `timepoint` (包含0wk, 1wk, 2wk, 6wk)。

**执行步骤 (Execution Steps):**

1.  **加载数据:** 读取指定的RDS文件并加载Seurat对象。
2.  **计算最小组大小:** 基于指定的“分组列名”，计算并确定所有组中细胞数量最少的组，记录其细胞数（即 `min_cell_count`）。
3.  **执行降采样:**
    *   设置一个随机种子 (`set.seed`) 以确保结果可重复。
    *   对元数据(metadata)进行操作：按“分组列名”对细胞进行分组。
    *   在每个组内，随机抽取 `min_cell_count` 个细胞。
    *   将所有抽取出的细胞的标识符（barcodes/cell names）合并成一个列表。
4.  **创建子集对象:**
    *   使用上一步得到的细胞标识符列表，从原始的Seurat对象中创建一个新的、仅用于可视化的子集对象。请注意，不要覆盖原始对象。
5.  **生成UMAP图:**
    *   使用这个新的、降采样后的Seurat子集对象生成一个`DimPlot`。
    *   在图中，点的颜色应按“分组列名”进行着色，以便清晰地比较不同组的分布。

**最终交付成果 (Expected Output):**

1.  **一个UMAP图文件 (PNG或PDF格式):** 图中清晰地展示了降采样后各个组别的细胞分布。图中每个组的点数应完全相同。
2.  **生成该图的完整R代码脚本。**